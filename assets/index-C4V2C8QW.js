import{R as w,j as e,d as g,r as m,e as l,f as b,s as I,h as P}from"./index-IJfFLadi.js";import{B as S}from"./index-ZjIKllaa.js";import{A as D}from"./Arrow-PaJV7mQ1.js";import"./vendor-CwAj_GBv.js";const x=w.forwardRef((s,a)=>s.showSkeleton?e.jsx("div",{className:g("yr-skeleton yr-image",s.className)}):e.jsx("img",{ref:a,...s,className:g("yr-image",s.className),loading:s.priority||"lazy"}));x.displayName="Image";const R=m.memo(function(s){const{av:a,selectedAvId:r,onClickCallback:c}=s,i=`fc-swatch-wrapper--img ${a.id===r?"fc-swatch-wrapper--img--selected":"fc-swatch-wrapper--img--border"}`,t=m.useCallback((d,o)=>(o.preventDefault(),o.stopPropagation(),c?c(d,o):o),[c]);return e.jsx("button",{type:"button",className:"fc-swatch",onClick:d=>t(a,d),children:e.jsxs("div",{className:"fc-swatch-wrapper",children:[e.jsx("div",{className:i,children:e.jsx(x,{src:a.testUrl,alt:a.name})}),e.jsx("div",{className:"fc-swatch-wrapper--name",children:e.jsx("span",{children:a?.name})})]})})}),O=s=>{const{remainingItems:a,label:r,onClickCallback:c}=s,i=m.useCallback(t=>(t.preventDefault(),t.stopPropagation(),c?c(t):t),[c]);return e.jsx("button",{type:"button",className:"fc-view-more",onClick:i,children:e.jsxs("div",{className:"fc-view-more--wrapper",children:[e.jsx("div",{className:"fc-view-more--wrapper--amount",children:`+ ${a}`}),e.jsx("div",{className:"fc-view-more--wrapper--name",children:e.jsx("span",{children:r})})]})})};function T(s){const{alias:a,icon:r,avs:c,currentPage:i,avsLenght:t,caName:d}=s.menu,[o,f]=m.useState(s.menu.selectedAvId),[k,v]=m.useState(s.menu.selectedAvName),[h,N]=m.useState(!1),y=()=>{const n=l.luxAPI.reloadPagination(s.menu);return b(n)},C=async(n,u)=>{try{await l.setRecipe([{ca:{alias:a},av:{id:n.id}}]);const p=l.luxAPI.getToken();l.rtrAPI.handleTokenChange(p);const A=l.getImg();I(p,A),f(n.id),v(n.name),l.assetsWorker.preloadAssets(a),u.preventDefault(),u.stopPropagation()}catch(p){console.log(p)}},j=n=>{l.assetsWorker.preloadAssets(a),n.preventDefault(),N(!h)};return e.jsxs("details",{open:h,className:"yr-accordion",onClick:j,children:[e.jsxs("summary",{className:"yr-accordion-summary",children:[e.jsx(x,{src:r,alt:a,className:"yr-accordion-summary-image"}),e.jsxs("div",{className:"yr-accordion-header",children:[e.jsx("h3",{className:"yr-accordion-header-title",children:d}),e.jsx("p",{className:"yr-accordion-header-selected",children:k})]}),e.jsx(S,{icon:e.jsx(D,{size:16,direction:h?"up":"down",className:"yr-accordion-arrow"}),onClick:j})]}),e.jsx("div",{className:"yr-accordion-content",children:h&&e.jsxs("ul",{className:"fc-attribute-values","aria-label":"attribute values menu",children:[c&&c?.length&&c.map((n,u)=>e.jsx("li",{children:e.jsx(R,{av:n,caAlias:a,selectedAvId:o,index:u,onClickCallback:C})},n.id||u)),i<t&&e.jsx("li",{children:e.jsx(O,{remainingItems:t-i,label:"view more",onClickCallback:y})},c?.length)]})})]})}const V=w.memo(function({corePromise:a}){a.read();const[r]=P();return e.jsx(e.Fragment,{children:r.map(c=>e.jsx(T,{menu:c},c.id))})});export{V as default};
